import tkinter as tk
from tkinter import ttk, messagebox

class RamanCalculator(tk.Tk):
    def __init__(self):
        super().__init__()

        self.title("Raman Shift Calculator")
        self.geometry("400x350")
        self.resizable(False, False)

        # Style configuration
        style = ttk.Style(self)
        style.theme_use('clam')
        style.configure("TLabel", font=("Helvetica", 11))
        style.configure("TButton", font=("Helvetica", 10, "bold"))

        # --- Header ---
        header_frame = ttk.Frame(self, padding="20 20 20 10")
        header_frame.pack(fill=tk.X)

        ttk.Label(header_frame, text="Raman Shift Converter", font=("Helvetica", 16, "bold")).pack()
        ttk.Label(header_frame, text="Enter Excitation + one other value", font=("Helvetica", 9, "italic")).pack()

        # --- Input Fields Frame ---
        input_frame = ttk.Frame(self, padding="20 10 20 20")
        input_frame.pack(fill=tk.BOTH, expand=True)

        # 1. Excitation Wavelength
        ttk.Label(input_frame, text="Excitation Wavelength (nm):").grid(row=0, column=0, sticky="w", pady=5)
        self.exc_var = tk.StringVar()
        self.entry_exc = ttk.Entry(input_frame, textvariable=self.exc_var)
        self.entry_exc.grid(row=0, column=1, sticky="e", pady=5)
        self.entry_exc.focus() # Focus here on start

        # 2. Scattered Wavelength
        ttk.Label(input_frame, text="Scattered Wavelength (nm):").grid(row=1, column=0, sticky="w", pady=5)
        self.meas_var = tk.StringVar()
        self.entry_meas = ttk.Entry(input_frame, textvariable=self.meas_var)
        self.entry_meas.grid(row=1, column=1, sticky="e", pady=5)

        # 3. Raman Shift
        ttk.Label(input_frame, text="Raman Shift (cm⁻¹):").grid(row=2, column=0, sticky="w", pady=5)
        self.shift_var = tk.StringVar()
        self.entry_shift = ttk.Entry(input_frame, textvariable=self.shift_var)
        self.entry_shift.grid(row=2, column=1, sticky="e", pady=5)

        # --- Buttons ---
        btn_frame = ttk.Frame(self, padding="20 10")
        btn_frame.pack(fill=tk.X)

        # Calculate Button
        self.btn_calc = ttk.Button(btn_frame, text="CALCULATE", command=self.calculate)
        self.btn_calc.pack(side=tk.LEFT, expand=True, fill=tk.X, padx=5)

        # Clear Button
        self.btn_clear = ttk.Button(btn_frame, text="CLEAR", command=self.clear_fields)
        self.btn_clear.pack(side=tk.RIGHT, expand=True, fill=tk.X, padx=5)

        # --- Result/Status Area ---
        self.status_var = tk.StringVar()
        self.status_var.set("Ready")
        lbl_status = ttk.Label(self, textvariable=self.status_var, foreground="gray", padding="0 0 0 10")
        lbl_status.pack(side=tk.BOTTOM)

    def calculate(self):
        """
        Performs the calculation based on which fields are filled.
        """
        exc_str = self.exc_var.get()
        meas_str = self.meas_var.get()
        shift_str = self.shift_var.get()

        # Validation: Excitation is always required
        if not exc_str:
            messagebox.showerror("Input Error", "Please enter the Excitation Wavelength (nm).")
            return

        try:
            lambda_exc = float(exc_str)

            # Scenario A: Calculate Shift (Excitation + Measured -> Shift)
            if meas_str and not shift_str:
                lambda_meas = float(meas_str)
                if lambda_meas == 0:
                    raise ValueError("Wavelength cannot be zero.")

                # Formula: (1/exc - 1/meas) * 10^7
                shift = (1/lambda_exc - 1/lambda_meas) * 10**7

                # Update the UI
                self.shift_var.set(f"{shift:.2f}")
                self.status_var.set(f"Calculated Shift: {shift:.2f} cm⁻¹")

            # Scenario B: Calculate Wavelength (Excitation + Shift -> Measured)
            elif shift_str and not meas_str:
                shift = float(shift_str)

                # Formula: 1 / (1/exc - shift/10^7)
                term = (1/lambda_exc) - (shift / 10**7)

                if term <= 0:
                     messagebox.showwarning("Physics Warning", "Resulting wavelength is infinite or negative (Anti-Stokes limit).")
                     return

                lambda_meas = 1 / term

                # Update the UI
                self.meas_var.set(f"{lambda_meas:.2f}")
                self.status_var.set(f"Calculated Wavelength: {lambda_meas:.2f} nm")

            # Scenario C: Both or neither filled
            elif meas_str and shift_str:
                 messagebox.showinfo("Ambiguous", "Both Measured Wavelength and Shift are filled.\nPlease clear the one you want to calculate.")
            else:
                 messagebox.showinfo("Input Missing", "Please enter either Measured Wavelength OR Raman Shift.")

        except ValueError:
            messagebox.showerror("Format Error", "Please ensure all inputs are valid numbers.")

    def clear_fields(self):
        """Clears the variable fields but keeps Excitation (usually constant)"""
        # self.exc_var.set("") # Uncomment if you want to clear excitation too
        self.meas_var.set("")
        self.shift_var.set("")
        self.status_var.set("Fields cleared")

if __name__ == "__main__":
    app = RamanCalculator()
    app.mainloop()
